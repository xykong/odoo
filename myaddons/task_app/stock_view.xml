<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>

        <record id="view_stock_move_tolerance_wizard" model="ir.ui.view">
            <field name="name">Tolerance Move</field>
            <field name="model">stock.move.tolerance</field>
            <field name="arch" type="xml">
                <form string="Tolerance Products">
                    <group>
                        <field name="product_id" readonly="1"/>
                        <label for="product_qty"/>
                        <div>
                            <field name="product_qty" class="oe_inline"/>
                            <field name="product_uom" class="oe_inline" readonly="1" groups="product.group_uom"/>
                        </div>
                        <field name="tolerance_price" readonly="1"/>
                        <field name="wipe_price" readonly="1"/>
                        <field name="restrict_lot_id" domain="[('product_id','=',product_id)]"
                               groups="stock.group_production_lot"
                               context="{'default_product_id': product_id}"/>
                        <field name="location_id" string="Tolerance Location" widget="selection"
                               domain="[('usage','!=','view'),('scrap_location','=',True)]"
                               groups="stock.group_locations"/>
                    </group>
                    <footer>
                        <button name="move_tolerance" string="Tolerance" type="object" class="oe_highlight"/>
                        or
                        <button string="Cancel" class="oe_link" special="cancel"/>
                    </footer>
                </form>
            </field>
        </record>

        <record id="move_tolerance" model="ir.actions.act_window">
            <field name="name">Tolerance Move</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">stock.move.tolerance</field>
            <field name="view_id" ref="view_stock_move_tolerance_wizard"/>
            <field name="view_type">form</field>
            <field name="view_mode">form</field>
            <field name="target">new</field>
            <field name="context">{'form_view_ref': False}</field>
        </record>

        <!--<record id="task_view_move_form" model="ir.ui.view">-->
            <!--<field name="name">stock.move.form - Extension</field>-->
            <!--<field name="model">stock.move</field>-->
            <!--<field name="priority" eval="18"/>-->
            <!--<field name="inherit_id" ref="stock.view_move_form"/>-->
            <!--<field name="arch" type="xml">-->
                <!--&lt;!&ndash;<button name="action_done" position="replace"/>&ndash;&gt;-->
                <!--&lt;!&ndash;<button name="action_confirm" position="replace"/>&ndash;&gt;-->
                <!--<button name="action_done" position="replace"/>-->
                <!--&lt;!&ndash;<button name="force_assign" position="replace"/>&ndash;&gt;-->
                <!--<button name="action_cancel" position="replace"/>-->
                <!--<button name="%(stock.move_scrap)d" position="replace"/>-->
            <!--</field>-->
        <!--</record>-->

        <record id="view_form_todo_task_inherited" model="ir.ui.view">
            <field name="name">stock.move.tree - Extension</field>
            <field name="model">stock.move</field>
            <field name="priority" eval="18"/>
            <field name="inherit_id" ref="stock.view_move_tree"/>
            <!--<field name="domain" eval="[('state','!=','done')]"/>-->
            <!--<field name="context">{'group_by':'location_dest_id'}</field>-->
            <!--<field name="context">{'search_default_group_by_product': True, 'search_default_group_by_location': True}-->
            <!--</field>-->
            <field name="arch" type="xml">
                <!--<tree colors="grey:state == 'cancel';red:(state not in ('cancel','done')) and date > current_date"-->
                <!--string="Moves">-->

                <!--<field name="origin" position="attributes">-->
                <!--<attribute name="invisible">True</attribute>-->
                <!--</field>-->

                <field name="product_uos" position="after">
                    <button name="%(task_app.move_tolerance)d"
                            string="Tolerance Products" type="action"
                            icon="terp-gtk-jump-to-ltr" context="{'tolerance': True}"
                            states="draft,waiting,confirmed,assigned"
                            groups="stock.group_stock_user"/>
                </field>

                <button name="%(stock.move_scrap)d" position="replace"/>
                <button name="action_done" position="replace"/>

                <!--<field name="origin_product_uos"/>-->

                <!--<field name="name"/>-->
                <!--<field name="picking_id" string="Reference"/>-->
                <!--<field name="origin"/>-->
                <!--<field name="picking_type_id"/>-->
                <!--<field name="create_date" invisible="1" groups="base.group_no_one"/>-->
                <!--<field name="product_id" on_change="onchange_product_id(product_id,location_id,location_dest_id, False)"/>-->
                <!--<field name="product_uom_qty" on_change="onchange_quantity(product_id, product_uom_qty, product_uom, product_uos)"/>-->
                <!--<field name="product_uom" string="Unit of Measure" groups="product.group_uom"/>-->
                <!--<field name="product_uos_qty" groups="product.group_uos"/>-->
                <!--<field name="product_uos" groups="product.group_uos"/>-->


                <!--<field name="location_id" groups="stock.group_locations"/>-->
                <!--<field name="location_dest_id" groups="stock.group_locations"/>-->
                <!--<field name="date" groups="base.group_no_one"/>-->
                <!--<field name="date_expected"/>-->
                <!--<field name="state"/>-->
                <!--<button name="action_done" states="confirmed,assigned" string="Process" type="object"-->
                <!--groups="stock.group_stock_user" icon="gtk-go-forward" help="Done"/>-->
                <!--</tree>-->
            </field>
        </record>

        <record id="view_form_todo_task_inherited_2" model="ir.ui.view">
            <field name="name">stock.move.tree - Extension</field>
            <field name="model">stock.move</field>
            <!--<field name="priority" eval="18"/>-->
            <!--<field name="inherit_id" ref="stock.view_move_tree"/>-->
            <field name="arch" type="xml">
                <tree colors="grey:state == 'cancel';red:(state not in ('cancel','done')) and date > current_date"
                      string="Moves">
                    <field name="name"/>
                    <field name="picking_id" string="Reference"/>
                    <field name="origin"/>
                    <field name="picking_type_id"/>
                    <field name="create_date" invisible="1" groups="base.group_no_one"/>
                    <field name="product_id"
                           on_change="onchange_product_id(product_id,location_id,location_dest_id, False)"/>
                    <field name="origin_product_uos"/>
                    <field name="product_uom_qty"
                           on_change="onchange_quantity(product_id, product_uom_qty, product_uom, product_uos)"/>
                    <field name="product_uom" string="Unit of Measure" groups="product.group_uom"/>
                    <field name="product_uos_qty" groups="product.group_uos"/>
                    <field name="product_uos" groups="product.group_uos"/>
                    <field name="location_id" groups="stock.group_locations"/>
                    <field name="location_dest_id" groups="stock.group_locations"/>
                    <field name="date" groups="base.group_no_one"/>
                    <field name="date_expected"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>

        <record id="view_move_search" model="ir.ui.view">
            <field name="name">stock.move.search</field>
            <field name="model">stock.move</field>
            <field eval="3" name="priority"/>
            <field name="arch" type="xml">
                <search string="Stock Moves">
                    <field name="origin"
                           filter_domain="['|', '|', ('origin', 'ilike', self), ('name', 'ilike', self), ('picking_id', 'ilike', self)]"
                           string="Reference"/>
                    <field name="date" groups="base.group_no_one"/>

                    <filter icon="terp-camera_test" string="Ready" name="ready" domain="[('state','=','assigned')]"
                            help="Stock moves that are Available (Ready to process)"/>
                    <filter icon="terp-stock" string="To Do" name="future"
                            domain="[('state','in',('assigned','confirmed','waiting'))]"
                            help="Stock moves that are Confirmed, Available or Waiting"/>
                    <filter icon="terp-dialog-close" string="Done" name="done" domain="[('state','=','done')]"
                            help="Stock moves that have been processed"/>
                    <separator/>
                    <filter icon="terp-go-today" string="Today"
                            domain="[('date','&lt;=', datetime.datetime.combine(context_today(), datetime.time(23,59,59))), ('date','&gt;=', datetime.datetime.combine(context_today(), datetime.time(0,0,0)))]"
                            help="Orders processed Today or planned for Today"/>
                    <field name="product_id"/>
                    <field name="name" string="Location"
                           filter_domain="['|',('location_id','ilike',self),('location_dest_id','ilike',self)]"/>
                    <field name="partner_id" string="Partner"
                           filter_domain="[('picking_id.partner_id','child_of',self)]"/>
                    <group expand="0" string="Group By">
                        <filter string="Product" name="by_product" icon="terp-accessories-archiver" domain="[]"
                                context="{'group_by':'product_id'}"/>
                        <filter string="Picking" name="groupby_picking_id" icon="terp-accessories-archiver" domain="[]"
                                context="{'group_by':'picking_id'}"/>
                        <filter string="Source" name="groupby_location_id" icon="terp-gtk-jump-to-rtl" domain="[]"
                                context="{'group_by':'location_id'}" groups="stock.group_locations"/>
                        <filter string="Destination" name="groupby_dest_location_id" icon="terp-gtk-jump-to-ltr"
                                domain="[]" context="{'group_by':'location_dest_id'}" groups="stock.group_locations"/>
                        <filter icon="terp-stock_effects-object-colorize" string="Status" domain="[]"
                                context="{'group_by':'state'}"/>
                        <filter string="Creation" name="groupby_create_date" icon="terp-go-month" domain="[]"
                                context="{'group_by':'create_date'}" groups="base.group_no_one"/>
                        <filter string="Scheduled" name="groupby_date" icon="terp-go-month" domain="[]"
                                context="{'group_by':'date_expected'}"/>
                    </group>
                </search>
            </field>
        </record>

        <record id="action_move_form2" model="ir.actions.act_window">
            <field name="name">Stock Moves</field>
            <field name="res_model">stock.move</field>
            <field name="type">ir.actions.act_window</field>
            <field name="view_type">form</field>
            <field name="view_id" ref="view_form_todo_task_inherited"/>
            <field name="search_view_id" ref="view_move_search"/>
            <field name="domain">[('state', '!=', 'done')]</field>
            <field name="context">{'group_by':'location_dest_id'}</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to create a stock movement.
                </p>
                <p>
                    This menu gives you the full traceability of inventory
                    operations on a specific product. You can filter on the product
                    to see all the past or future movements for the product.
                </p>
            </field>
        </record>

        <menuitem id="menu_task_stock_move"
                  name="menuitem Receive product"
                  parent="stock.menu_traceability"
                  sequence="20"
                  action="action_move_form2"/>

        <record id="action_view_base_import_shipping" model="ir.actions.act_window">
            <field name="name">Import Shipping Orders</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">task.import.shipping</field>
            <field name="view_type">form</field>
            <field name="view_mode">form</field>
            <field name="target">new</field>
        </record>

        <menuitem action="action_view_base_import_shipping"
                  id="menu_view_base_import_shipping"
                  parent="stock.menu_traceability"/>

    </data>
</openerp>
